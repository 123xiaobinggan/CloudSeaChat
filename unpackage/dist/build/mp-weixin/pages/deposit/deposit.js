"use strict";const e=require("../../common/vendor.js"),t=require("../../common/assets.js"),i={data:()=>({userInfo:{account_id:"",username:"未登录",avatar:"/static/info/未登录.png"},keys:["1","2","3","4","5","6","7","8","9"],rechargeAmount:"",isInputFocused:!1,hasInput:!1,activeiIndex:-1}),watch:{rechargeAmount(){this.isInputFocused=!0,this.hasInput=""!==this.rechargeAmount.toString().trim()&&this.rechargeAmount>0}},onLoad(){const e=getApp();this.userInfo=e.userInfo,this.isInputFocused=!0},methods:{handleKeyPress(e){if(this.triggerVibrate(),this.isInputFocused=!0,this.rechargeAmount.includes(".")){if(this.rechargeAmount.split(".")[1].length>=2||"."===e)return}"."===e&&""===this.rechargeAmount&&(this.rechargeAmount="0"),this.rechargeAmount+=e},handleBackspace(){this.triggerVibrate(),this.rechargeAmount=this.rechargeAmount.slice(0,-1)},handleBodyTap(){this.isInputFocused=!1},setActive(e){this.activeiIndex=e},removeActive(){this.activeiIndex=-1},async handleDeposit(){this.triggerVibrate();const t=parseFloat(parseFloat(this.rechargeAmount).toFixed(2));if(t<=0)return void e.index.showToast({title:"充值金额必须大于0",icon:"none"});e.index.showLoading({title:"充值中..."}),console.log("充值金额",t,"元");if(200===(await e.tr.callFunction({name:"deposit",data:{account_id:this.userInfo.account_id,amount:t}})).result.code){e.index.hideLoading(),e.index.showToast({title:"充值成功",icon:"success"});const i=getApp();i.userInfo.balance+=t,i.userInfo.balance=parseFloat(parseFloat(i.userInfo.balance).toFixed(2)),setTimeout((()=>{e.index.navigateBack()}),1e3)}else e.index.showToast({title:"充值失败",icon:"none"});e.index.hideLoading()},triggerVibrate(){e.index.vibrateShort(),setTimeout((()=>{e.index.vibrateShort()}),10),setTimeout((()=>{e.index.vibrateShort()}),20),setTimeout((()=>{e.index.vibrateShort()}),30)}}};const o=e._export_sfc(i,[["render",function(i,o,s,n,a,r){return e.e({a:e.t(a.userInfo.username),b:e.t(a.userInfo.account_id),c:a.userInfo.avatar,d:e.o(((...e)=>r.handleBodyTap&&r.handleBodyTap(...e))),e:t._imports_0$4,f:e.t(a.rechargeAmount),g:a.isInputFocused},(a.isInputFocused,{}),{h:e.o((e=>a.isInputFocused=!0)),i:e.f(a.keys,((t,i,o)=>({a:e.t(t),b:i,c:a.activeiIndex===i?1:"",d:e.o((e=>r.handleKeyPress(t)),i),e:e.o((e=>r.setActive(i)),i),f:e.o((e=>r.removeActive(i)),i)}))),j:"0"===a.activeiIndex?1:"",k:e.o((e=>r.handleKeyPress("0"))),l:e.o((e=>r.setActive("0"))),m:e.o((e=>r.removeActive("0"))),n:"."===a.activeiIndex?1:"",o:e.o((e=>r.handleKeyPress("."))),p:e.o((e=>r.setActive("."))),q:e.o((e=>r.removeActive("."))),r:t._imports_1$2,s:"back"===a.activeiIndex?1:"",t:e.o(((...e)=>r.handleBackspace&&r.handleBackspace(...e))),v:e.o((e=>r.setActive("back"))),w:e.o((e=>r.removeActive("back"))),x:a.isInputFocused,y:a.isInputFocused?"":1,z:e.o((()=>{})),A:a.hasInput?1:"",B:"deposit"===a.activeiIndex?1:"",C:a.isInputFocused?1:"",D:e.o(((...e)=>r.handleDeposit&&r.handleDeposit(...e))),E:e.o((e=>r.setActive("deposit"))),F:e.o((e=>r.removeActive("deposit"))),G:e.o(((...e)=>r.handleBodyTap&&r.handleBodyTap(...e)))})}],["__scopeId","data-v-05bdfed6"]]);wx.createPage(o);
