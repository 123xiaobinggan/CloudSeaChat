"use strict";const t=require("../../common/vendor.js"),o=require("../../common/assets.js"),e={data:()=>({meteors:[],meteorId:0,userInfo:{account_id:"",username:"未登录",description:"这个人很懒，什么都没有留下",avatar:"/static/info/未登录.png",level:0,activity:0,coupon:0,points:0,balance:0,admin:!1},login_status:!1,token:""}),watch:{},onShow(){setTimeout((()=>{const o=getApp();o.userInfo&&(Object.assign(this.userInfo,o.userInfo),this.login_status=o.login_status,this.userInfo.unread_messages&&t.index.showTabBarRedDot({index:1})),console.log("onShow",this.userInfo)}),100)},moundted(){this.startMeteorShower()},onLoad(){},onUnload(){this.token&&(t.PubSub.unsubscribe(this.token),this.token=null)},methods:{goToEdit(){t.index.navigateTo({url:"/pages/edit/edit"})},to_detail(){t.index.showActionSheet({itemList:["编辑资料","个人主页"],success:o=>{0===o.tapIndex?this.goToEdit():1===o.tapIndex&&t.index.navigateTo({url:`/pages/personal_info/personal_info?account_id=${this.userInfo.account_id}&visitor_account_id=${this.userInfo.account_id}&visitor_admin=${this.userInfo.admin}`})}})},startMeteorShower(){setInterval((()=>{const t=this.meteorId++,o=100*Math.random(),e=100*Math.random(),n=100+100*Math.random(),s=.3+.5*Math.random(),i=.5+Math.random(),a=["#fff","#bde2ff","#f0c9ff"][Math.floor(3*Math.random())];this.meteors.push({id:t,style:`\n             left: ${o}%;\n             top: ${e}%;\n             width: ${n}rpx;\n             height: 2rpx;\n             opacity: ${s};\n             background: linear-gradient(to right, ${a}, transparent);\n             animation: meteor-fly ${i}s linear forwards;\n           `}),setTimeout((()=>{this.meteors=this.meteors.filter((o=>o.id!==t))}),1e3*i)}),300)},login(){t.index.navigateTo({url:"/pages/login/login"})},logout(){t.index.showToast({title:"退出登录",icon:"success"}),this.login_status=!1,this.userInfo={username:"未登录",account_id:"",description:"这个人很懒，什么都没有留下",avatar:"/static/info/未登录.png",level:0,activity:0,coupon:0,points:0,balance:0,admin:!1},t.index.removeStorageSync("uid");const o=getApp();o.userInfo=this.userInfo,o.login_status=this.login_status,t.index.hideTabBarRedDot({index:1})},deposit(){t.index.navigateTo({url:"/pages/deposit/deposit"})}}};const n=t._export_sfc(e,[["render",function(e,n,s,i,a,r){return{a:a.userInfo.avatar,b:t.o(((...t)=>r.to_detail&&r.to_detail(...t))),c:t.t(a.userInfo.username),d:t.t(a.userInfo.account_id),e:t.t(a.userInfo.level),f:t.t(a.userInfo.activity),g:t.t(a.userInfo.description),h:o._imports_0$2,i:a.login_status,j:t.o(((...t)=>r.goToEdit&&r.goToEdit(...t))),k:!a.login_status,l:t.o(((...t)=>r.login&&r.login(...t))),m:a.login_status,n:t.o(((...t)=>r.logout&&r.logout(...t))),o:t.t(a.userInfo.coupon),p:t.t(a.userInfo.points),q:t.t(a.userInfo.balance),r:t.o(((...t)=>r.deposit&&r.deposit(...t))),s:t.t(100-a.userInfo.activity%100),t:t.s("width:"+a.userInfo.activity+"%"),v:t.f(a.meteors,((o,e,n)=>({a:o.id,b:t.s(o.style)})))}}],["__scopeId","data-v-e4ad67fe"]]);wx.createPage(n);
