{"version":3,"names":["_sfc_main","data","username","password","methods","handleLogin","_this","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","res","wrap","_callee$","_context","prev","next","common_vendor","er","callFunction","name","action","sent","result","code","index","showToast","title","icon","utils_pubsub","pubsub","publish","userInfo","switchTab","url","msg","t0","__f__","stop","goToRegister","navigateTo","wx","createPage","MiniProgramPage"],"sources":["login.vue","cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n  <view class=\"login-container\">\r\n    <input v-model=\"username\" placeholder=\"用户名(2-13个字符)\" class=\"input-field\" />\r\n    <input v-model=\"password\" type=\"password\" placeholder=\"密码\" class=\"input-field\" />\r\n    <button @click=\"handleLogin\" class=\"login-button\">登录</button>\r\n    <view class=\"register-link\" @click=\"goToRegister\">没有账号？去注册</view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { pubsub } from '../../utils/pubsub'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      username: '',\r\n      password: ''\r\n    }\r\n  },\r\n  methods: {\r\n    async handleLogin() {\r\n      try {\r\n        const res = await uniCloud.callFunction({\r\n          name: 'connect',\r\n          data: {\r\n            action: 'login',\r\n            username: this.username,\r\n            password: this.password\r\n          }\r\n        })\r\n        \r\n        if (res.result.code === 0) {\r\n          uni.showToast({ title: '登录成功', icon: 'success' })\r\n          \r\n          pubsub.publish('updateUserInfo', res.result.userInfo)\r\n          uni.switchTab({ url: '/pages/index/index' })\r\n        } else {\r\n          uni.showToast({ title: res.result.msg, icon: 'none' })\r\n        }\r\n      } catch (e) {\r\n        uni.showToast({ title: '登录失败', icon: 'none' })\r\n        console.error(e)\r\n      }\r\n    },\r\n    goToRegister() {\r\n      uni.navigateTo({\r\n        url: '/pages/register/register'\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n@import url(login.css);\r\n</style>","import MiniProgramPage from 'D:/CODE/vue/canteen_program/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"mappings":";;;;;;;AAYA,IAAKA,SAAA,GAAU;EACbC,IAAA,WAAAA,KAAA,EAAO;IACL,OAAO;MACLC,QAAA,EAAU;MACVC,QAAA,EAAU;IACZ;EACD;EACDC,OAAA,EAAS;IACDC,WAAA,WAAAA,YAAA,EAAc;MAAA,IAAAC,KAAA;MAAA,OAAAC,kBAAA,eAAAC,oBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,GAAA;QAAA,OAAAH,oBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAEEC,aAAA,CAAQC,EAAA,CAACC,YAAA,CAAa;gBACtCC,IAAA,EAAM;gBACNnB,IAAA,EAAM;kBACJoB,MAAA,EAAQ;kBACRnB,QAAA,EAAUI,KAAA,CAAKJ,QAAA;kBACfC,QAAA,EAAUG,KAAA,CAAKH;gBACjB;cAAA,CACD;YAAA;cAPKQ,GAAA,GAAAG,QAAA,CAAAQ,IAAA;cASN,IAAIX,GAAA,CAAIY,MAAA,CAAOC,IAAA,KAAS,GAAG;gBACzBP,aAAA,CAAGQ,KAAA,CAACC,SAAA,CAAU;kBAAEC,KAAA,EAAO;kBAAQC,IAAA,EAAM;gBAAA,CAAW;gBAEhDC,YAAA,CAAAC,MAAA,CAAOC,OAAA,CAAQ,kBAAkBpB,GAAA,CAAIY,MAAA,CAAOS,QAAQ;gBACpDf,aAAA,CAAAQ,KAAA,CAAIQ,SAAA,CAAU;kBAAEC,GAAA,EAAK;gBAAA,CAAsB;cAAA,OACtC;gBACLjB,aAAA,CAAAQ,KAAA,CAAIC,SAAA,CAAU;kBAAEC,KAAA,EAAOhB,GAAA,CAAIY,MAAA,CAAOY,GAAA;kBAAKP,IAAA,EAAM;gBAAA,CAAQ;cACvD;cAAAd,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAsB,EAAA,GAAAtB,QAAA;cAEAG,aAAA,CAAGQ,KAAA,CAACC,SAAA,CAAU;gBAAEC,KAAA,EAAO;gBAAQC,IAAA,EAAM;cAAA,CAAQ;cAC7CX,aAAA,CAAAQ,KAAA,CAAAY,KAAA,yCAAAvB,QAAA,CAAAsB,EAAA,CAAe;YAAA;YAAA;cAAA,OAAAtB,QAAA,CAAAwB,IAAA;UAAA;QAAA,GAAA5B,OAAA;MAAA;IAElB;IACD6B,YAAA,WAAAA,aAAA,EAAe;MACbtB,aAAA,CAAAQ,KAAA,CAAIe,UAAA,CAAW;QACbN,GAAA,EAAK;MAAA,CACN;IACH;EACF;AACF;;;;;;;;;;;;;;;;;;;;ACjDAO,EAAA,CAAGC,UAAA,CAAWC,eAAe","ignoreList":[]}