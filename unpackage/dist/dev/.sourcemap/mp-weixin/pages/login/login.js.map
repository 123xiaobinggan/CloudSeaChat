{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../../H-builderx/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n  <view class=\"login-container\">\r\n    <input v-model=\"userInfo.account_id\" placeholder=\"ID(2-13个字符)\" class=\"input-field\" />\r\n    <input v-model=\"userInfo.password\" type=\"password\" placeholder=\"密码\" class=\"input-field\" />\r\n    <button @tap=\"handleLogin\" class=\"login-button\">登录</button>\r\n    <view class=\"register-link\" @tap=\"goToRegister\">没有账号？去注册</view>\r\n  </view>\r\n</template>\r\n\r\n<script >\r\nexport default {\r\n  data() {\r\n    return {\r\n      userInfo:{\r\n        account_id: '',\r\n        username: '',\r\n        password: '',\r\n        description: '茶里茶气的生活家',\r\n        avatar: '/static/info/头像.png',\r\n        level: 2,\r\n        activity: 24,\r\n        coupon: 0,\r\n        points: 24,\r\n        balance: 99.9\r\n      },\r\n      loading: false\r\n    }\r\n  },\r\n  watch:{\r\n    loading(val){\r\n      if(val){\r\n        uni.showLoading({ title: '登录中...' })\r\n      }else{\r\n        uni.hideLoading()\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async handleLogin() {\r\n      this.loading = true;\r\n      try {\r\n        const res = await uniCloud.callFunction({\r\n          name: 'login_register',\r\n          data: {\r\n            action: 'login',\r\n            account_id: this.userInfo.account_id,\r\n\t\t\t      username: '',\r\n            password: this.userInfo.password,\r\n            has_token: false\r\n          }\r\n        })\r\n\r\n        if (res.result.code === 200) {\r\n          const app = getApp();\r\n          app.userInfo = res.result.userInfo;\r\n          app.login_status = true;\r\n          uni.setStorageSync('uid', res.result.userInfo.account_id);\r\n          this.loading = false;\r\n          uni.showToast({ title: '登录成功', icon: 'success' })\r\n          setTimeout(() => {\r\n            uni.switchTab({ url: '/pages/my_info/my_info' })\r\n          }, 1000)\r\n        } else {\r\n          uni.showToast({ title: res.result.msg, icon: 'none' })\r\n        }\r\n      } catch (e) {\r\n        uni.showToast({ title: '登录失败', icon: 'none' })\r\n        console.error(e)\r\n      }finally{\r\n        this.loading = false;\r\n      }\r\n    },\r\n    goToRegister() {\r\n      uni.navigateTo({\r\n        url: '/pages/register/register'\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n@import url(login.css);\r\n</style>","import MiniProgramPage from 'D:/CODE/vue/canteen_program/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;AAUA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,UAAS;AAAA,QACP,YAAY;AAAA,QACZ,UAAU;AAAA,QACV,UAAU;AAAA,QACV,aAAa;AAAA,QACb,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,SAAS;AAAA,MACV;AAAA,MACD,SAAS;AAAA,IACX;AAAA,EACD;AAAA,EACD,OAAM;AAAA,IACJ,QAAQ,KAAI;AACV,UAAG,KAAI;AACLA,sBAAAA,MAAI,YAAY,EAAE,OAAO,UAAU;AAAA,aAChC;AACHA,sBAAAA,MAAI,YAAY;AAAA,MAClB;AAAA,IACF;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,MAAM,cAAc;AAClB,WAAK,UAAU;AACf,UAAI;AACF,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACtC,MAAM;AAAA,UACN,MAAM;AAAA,YACJ,QAAQ;AAAA,YACR,YAAY,KAAK,SAAS;AAAA,YAC7B,UAAU;AAAA,YACP,UAAU,KAAK,SAAS;AAAA,YACxB,WAAW;AAAA,UACb;AAAA,SACD;AAED,YAAI,IAAI,OAAO,SAAS,KAAK;AAC3B,gBAAM,MAAM;AACZ,cAAI,WAAW,IAAI,OAAO;AAC1B,cAAI,eAAe;AACnBD,wBAAG,MAAC,eAAe,OAAO,IAAI,OAAO,SAAS,UAAU;AACxD,eAAK,UAAU;AACfA,wBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,WAAW;AAChD,qBAAW,MAAM;AACfA,0BAAAA,MAAI,UAAU,EAAE,KAAK,0BAA0B;AAAA,UAChD,GAAE,GAAI;AAAA,eACF;AACLA,8BAAI,UAAU,EAAE,OAAO,IAAI,OAAO,KAAK,MAAM,QAAQ;AAAA,QACvD;AAAA,MACF,SAAS,GAAG;AACVA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAC7CA,sBAAAA,MAAA,MAAA,SAAA,+BAAc,CAAC;AAAA,MACjB,UAAC;AACC,aAAK,UAAU;AAAA,MACjB;AAAA,IACD;AAAA,IACD,eAAe;AACbA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,OACN;AAAA,IACF;AAAA,EACH;AACF;;;;;;;;;;;;AC7EA,GAAG,WAAW,eAAe;"}